// Başlıkları filteredData'nın ilk elemanının key'lerinden dinamik al
const headers = Object.keys(filteredData[0]);

// Başlık satırını oluştur
const headerRow = headers.map(header => {
    if (typeof header === 'string' && (header.includes(',') || header.includes('"') || header.includes('\n'))) {
        return `"${header.replace(/"/g, '""')}"`;
    }
    return header;
}).join(',');

// Veri satırlarını oluştur
const dataRows = filteredData.map(row => 
    Object.values(row).map(cell => {
        if (typeof cell === 'string' && (cell.includes(',') || cell.includes('"') || cell.includes('\n'))) {
            return `"${cell.replace(/"/g, '""')}"`;
        }
        return cell;
    }).join(',')
).join('\n');

// Başlık ve veriyi birleştir
const csvContent = headerRow + '\n' + dataRows;

const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    
// İndirme linki oluştur
const link = document.createElement('a');
const url = URL.createObjectURL(blob);

link.setAttribute('href', url);
link.setAttribute('download', "deneme.csv");
link.style.visibility = 'hidden';

// Linki sayfaya ekle, tıkla ve kaldır
document.body.appendChild(link);
link.click();

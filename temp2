private string GetJsonDataFromDatabase()
{
    string connectionString = "YourConnectionStringHere";
    string query = @"SELECT name, amount, created_at, parent FROM your_table ORDER BY created_at DESC";

    var allItems = new Dictionary<string, Dictionary<string, object>>();
    var roots = new List<Dictionary<string, object>>();

    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();
        SqlCommand command = new SqlCommand(query, connection);
        SqlDataReader reader = command.ExecuteReader();

        while (reader.Read())
        {
            string name = reader["name"].ToString();
            string parent = reader["parent"] == DBNull.Value ? null : reader["parent"].ToString();
            int amount = Convert.ToInt32(reader["amount"]);
            DateTime createdAt = Convert.ToDateTime(reader["created_at"]);

            var rowData = new Dictionary<string, object>
            {
                { "name", name },
                { "amount", amount },
                { "created_at", createdAt },
                { "parent", parent },
                { "children", new List<Dictionary<string, object>>() }
            };

            allItems[name] = rowData;
        }
    }

    // Parent-child ilişkilerini kur
    foreach (var item in allItems.Values)
    {
        var parentName = item["parent"] as string;
        if (parentName != null && allItems.ContainsKey(parentName))
        {
            var parent = allItems[parentName];
            ((List<Dictionary<string, object>>)parent["children"]).Add(item);
        }
        else
        {
            roots.Add(item); // root node
        }
    }

    var jsonSerializer = new JavaScriptSerializer { MaxJsonLength = int.MaxValue };
    return jsonSerializer.Serialize(roots); // sadece köklerden başlıyoruz, children içinde her şey var
}

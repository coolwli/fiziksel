# Her satır için işlemi başlatıyoruz
foreach ($row in $rows) {
    # Datastore hücresini alıyoruz
    $datastores = $row.cells[7]

    # IrregularRows dizisini başlatıyoruz
    $irregularRows = @()

    # Datastore'ları virgülle ayırıyoruz
    foreach ($ds in $datastores -split ',') {
        # "repzl" içermeyen datastore'ları kontrol ediyoruz
        if ($ds -notcontains "repzl") {
            # İlgili değerleri irregularRows dizisine ekliyoruz
            # $ds.1, $ds.5, $ds.7 gibi alanlara doğrudan erişmeye çalışıyoruz
            # Bu noktada ds nesnesinin içeriği doğru formatta olduğundan emin olmalıyız
            $irregularRows += [PSCustomObject]@{
                ObjId   = $ds.objId
                Field1  = $ds.1
                Field5  = $ds.5
                Field7  = $ds.7
            }

            # Sadece ilk uyumsuz satırla işlem yapıldıktan sonra iç döngüden çıkıyoruz
            break
        }
    }

    # IrregularRows dizisini birleştirip yazdırıyoruz
    $irregularRows
}

# Sonuçları seçip yazdırıyoruz
$irregularRows | Select-Object *

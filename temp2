private Dictionary<string, Dictionary<string, int[]>> GetAllDatasets(string query)
{
    var datasets = new Dictionary<string, Dictionary<string, int[]>>();

    using (var con = new SqlConnection(connectionString))
    {
        con.Open();
        using (var cmd = new SqlCommand(query, con))
        {
            using (var reader = cmd.ExecuteReader())
            {
                // Sütun isimlerini ve değerlerini dinamik olarak saklamak için geçici bir yapı
                var tempData = new Dictionary<string, List<int>>();

                while (reader.Read())
                {
                    // Her sütun için işlemler yapılacak
                    for (int i = 0; i < reader.FieldCount; i++)
                    {
                        var columnName = reader.GetName(i);
                        var value = reader.GetValue(i);

                        // Eğer değer int türünde değilse geç
                        if (value is int intValue)
                        {
                            // Geçici yapıda toplama yapılacak
                            if (!tempData.ContainsKey(columnName))
                            {
                                tempData[columnName] = new List<int>();
                            }

                            // Dinamik isimlerin tutulması
                            tempData[columnName].Add(intValue);
                        }
                    }
                }

                // Geçici yapıdan ana yapıya dönüşüm
                foreach (var entry in tempData)
                {
                    var columnName = entry.Key;
                    var values = entry.Value;

                    // Değerleri gruplamak için Dictionary
                    var groupedData = new Dictionary<string, int[]>();

                    for (int j = 0; j < values.Count; j++)
                    {
                        var dynamicName = $"row{j}"; // Örnek dinamik isim
                        groupedData[dynamicName] = new int[values.Count];
                        groupedData[dynamicName][j] = values[j];
                    }

                    // Sonucu datasets'e ekleme
                    datasets[columnName] = groupedData;
                }
            }
        }
    }

    return datasets;
}

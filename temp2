using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;
using System.Web.UI;

namespace historicDatas
{
    public partial class _default : System.Web.UI.Page
    {
        private readonly string connectionString = @"Data Source=TEKSCR1\SQLEXPRESS;Initial Catalog=CloudUnited;Integrated Security=True";

        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                string sqlQuery = "SELECT * FROM Veriler"; 
                var allDatas = GetAllDatasets(sqlQuery);

                foreach (var data in allDatas)
                {
                    //ekraba yazdır
                }
            }
        }

        private Dictionary<string, Dictionary<string, int[]>> GetAllDatasets(string query)
        {
            var datasets = new Dictionary<string, Dictionary<string, int[]>>();

            using (var con = new SqlConnection(connectionString))
            {
                con.Open();
                using (var cmd = new SqlCommand(query, con))
                {
                    using (var reader = cmd.ExecuteReader())
                    {
                        var tempData = new Dictionary<string, List<int>>();

                        while (reader.Read())
                        {
                            for (int i = 0; i < reader.FieldCount; i++)
                            {
                                var columnName = reader.GetName(i);
                                var value = reader.GetValue(i);
                                /*simple value gün gün 
                                    CISCO|798~IBM|3~DELL|24~HPE|810~Lenovo|2~MEINBERG|7~FUJITSU|687~
                                    CISCO | 798~IBM | 3~DELL | 24~HPE | 810~Lenovo | 2~MEINBERG | 7~FUJITSU | 687~
                                    CISCO | 798~IBM | 3~DELL | 24~HPE | 810~Lenovo | 2~MEINBERG | 7~FUJITSU | 687~
                                    CISCO | 793~IBM | 3~DELL | 24~HPE | 810~Lenovo | 2~MEINBERG | 7~FUJITSU | 687~
                                    şeklinde her bir değişken için uygun bir dizide tutmalıyız cisco icin bir dizi ibm icin bir dizi gibi
                                    sonra bunu tuple kullanmadan uygun bir veri yapısıyla gerş döndğrmeliyim
                                */

                            }
                        }
                        
                    }
                }
            }

            return datasets;
        }
    }
}

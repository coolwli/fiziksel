using System;
using System.Data;
using System.Data.OleDb;
using System.Web.UI.WebControls;

public partial class ExcelRead : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            // Excel dosyasının yolunu belirtin
            string excelFilePath = Server.MapPath("~/App_Data/veriler.xlsx");

            // Excel dosyasını okumak için bağlantı dizesi oluşturun
            string excelConnString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excelFilePath + ";Extended Properties=\"Excel 12.0;HDR=YES;IMEX=2\";";

            // Excel dosyasına bağlanın ve veri okuyun
            using (OleDbConnection excelConn = new OleDbConnection(excelConnString))
            {
                excelConn.Open();
                DataTable dtExcelSchema;
                dtExcelSchema = excelConn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);
                string sheetName = dtExcelSchema.Rows[0]["TABLE_NAME"].ToString();
                OleDbCommand cmd = new OleDbCommand("SELECT * FROM [" + sheetName + "]", excelConn);
                OleDbDataAdapter oda = new OleDbDataAdapter();
                oda.SelectCommand = cmd;
                DataTable dt = new DataTable();
                oda.Fill(dt);

                // DataTable'daki verileri GridView'e bağlayın
                GridView1.DataSource = dt;
                GridView1.DataBind();

                excelConn.Close();
            }
        }
    }
}
